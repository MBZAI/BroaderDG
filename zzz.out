Incomplete: ./domainbed/Outputs/ZZZ_SANOJAN_RND/e5fde84d5a7648e7adca898fcf235b02 ('DR', 'Clip_train_prompt_from_image', [0], 0)
Incomplete: ./domainbed/Outputs/ZZZ_SANOJAN_RND/f2466a292c5148598b13943cde65c51d ('DR', 'Clip_train_prompt_from_image', [1], 0)
Incomplete: ./domainbed/Outputs/ZZZ_SANOJAN_RND/7cb6a38e25d3e51a2febcd867922c025 ('DR', 'Clip_train_prompt_from_image', [2], 0)
Incomplete: ./domainbed/Outputs/ZZZ_SANOJAN_RND/000f5b7c71ff60fffd66ac229b0785f1 ('DR', 'Clip_train_prompt_from_image', [3], 0)
4 jobs: 0 done, 4 incomplete, 0 not launched.
About to delete 4 jobs.
Deleting...
Deleted 4 jobs!
Not launched: ./domainbed/Outputs/ZZZ_SANOJAN_RND/e5fde84d5a7648e7adca898fcf235b02 ('DR', 'Clip_train_prompt_from_image', [0], 0)
Not launched: ./domainbed/Outputs/ZZZ_SANOJAN_RND/f2466a292c5148598b13943cde65c51d ('DR', 'Clip_train_prompt_from_image', [1], 0)
Not launched: ./domainbed/Outputs/ZZZ_SANOJAN_RND/7cb6a38e25d3e51a2febcd867922c025 ('DR', 'Clip_train_prompt_from_image', [2], 0)
Not launched: ./domainbed/Outputs/ZZZ_SANOJAN_RND/000f5b7c71ff60fffd66ac229b0785f1 ('DR', 'Clip_train_prompt_from_image', [3], 0)
4 jobs: 0 done, 0 incomplete, 4 not launched.
About to launch 4 jobs.
Launching...
Making job directories:
Environment:
	Python: 3.8.11
	PyTorch: 1.9.0+cu102
	Torchvision: 0.10.0+cu102
	CUDA: 10.2
	CUDNN: 7605
	NumPy: 1.21.1
	PIL: 9.1.0
Args:
	algorithm: Clip_train_prompt_from_image
	checkpoint_freq: None
	data_dir: /nfs/users/ext_group8/Dataset/224_data/
	dataset: DR
	holdout_fraction: 0.2
	hparams: {"weight_init":"clip_full","backbone":"ClipBase","lr":0.000005}
	hparams_seed: 0
	output_dir: ./domainbed/Outputs/ZZZ_SANOJAN_RND/e5fde84d5a7648e7adca898fcf235b02
	save_best_model: True
	save_model_every_checkpoint: False
	seed: 1143776018
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	backbone: ClipBase
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	test_env: [0]
	weight_decay: 0.0
	weight_init: clip_full
device: cuda
0
transformer_width: 512 ;transformer_layers: 12 ;transformer_heads: 8
512 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
torch.Size([96, 512]) torch.Size([96, 77, 512]) torch.Size([96, 4, 512])
Traceback (most recent call last):
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/nfs/users/ext_group8/Repos/BroaderDG/domainbed/scripts/train.py", line 389, in <module>
    save_checkpoint(f"model_best_acc_step_{step}.pkl", "model_best_acc")
  File "/nfs/users/ext_group8/Repos/BroaderDG/domainbed/scripts/train.py", line 323, in save_checkpoint
    "model_dict": copy.deepcopy(algorithm).cpu().state_dict(),
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/copy.py", line 172, in deepcopy
    y = _reconstruct(x, memo, *rv)
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/copy.py", line 270, in _reconstruct
    state = deepcopy(state, memo)
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/copy.py", line 146, in deepcopy
    y = copier(x, memo)
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/copy.py", line 230, in _deepcopy_dict
    y[deepcopy(key, memo)] = deepcopy(value, memo)
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/copy.py", line 153, in deepcopy
    y = copier(memo)
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/site-packages/torch/_tensor.py", line 55, in __deepcopy__
    raise RuntimeError("Only Tensors created explicitly by the user "
RuntimeError: Only Tensors created explicitly by the user (graph leaves) support the deepcopy protocol at the moment
Environment:
	Python: 3.8.11
	PyTorch: 1.9.0+cu102
	Torchvision: 0.10.0+cu102
	CUDA: 10.2
	CUDNN: 7605
	NumPy: 1.21.1
	PIL: 9.1.0
Args:
	algorithm: Clip_train_prompt_from_image
	checkpoint_freq: None
	data_dir: /nfs/users/ext_group8/Dataset/224_data/
	dataset: DR
	holdout_fraction: 0.2
	hparams: {"weight_init":"clip_full","backbone":"ClipBase","lr":0.000005}
	hparams_seed: 0
	output_dir: ./domainbed/Outputs/ZZZ_SANOJAN_RND/f2466a292c5148598b13943cde65c51d
	save_best_model: True
	save_model_every_checkpoint: False
	seed: 1186041810
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [1]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	backbone: ClipBase
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	test_env: [1]
	weight_decay: 0.0
	weight_init: clip_full
device: cuda
1
transformer_width: 512 ;transformer_layers: 12 ;transformer_heads: 8
512 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Traceback (most recent call last):
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/nfs/users/ext_group8/Repos/BroaderDG/domainbed/scripts/train.py", line 296, in <module>
    algorithm = algorithm_class(dataset.input_shape, dataset.num_classes,
  File "/nfs/users/ext_group8/Repos/BroaderDG/domainbed/algorithms.py", line 1009, in __init__
    for param in self.featurizer.parameters():
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'Clip_train_prompt_from_image' object has no attribute 'biobert_mlp_model'
Environment:
	Python: 3.8.11
	PyTorch: 1.9.0+cu102
	Torchvision: 0.10.0+cu102
	CUDA: 10.2
	CUDNN: 7605
	NumPy: 1.21.1
	PIL: 9.1.0
Args:
	algorithm: Clip_train_prompt_from_image
	checkpoint_freq: None
	data_dir: /nfs/users/ext_group8/Dataset/224_data/
	dataset: DR
	holdout_fraction: 0.2
	hparams: {"weight_init":"clip_full","backbone":"ClipBase","lr":0.000005}
	hparams_seed: 0
	output_dir: ./domainbed/Outputs/ZZZ_SANOJAN_RND/7cb6a38e25d3e51a2febcd867922c025
	save_best_model: True
	save_model_every_checkpoint: False
	seed: 1309921430
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [2]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	backbone: ClipBase
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	test_env: [2]
	weight_decay: 0.0
	weight_init: clip_full
device: cuda
2
transformer_width: 512 ;transformer_layers: 12 ;transformer_heads: 8
512 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
torch.Size([96, 512]) torch.Size([96, 77, 512]) torch.Size([96, 4, 512])
Traceback (most recent call last):
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/nfs/users/ext_group8/Repos/BroaderDG/domainbed/scripts/train.py", line 347, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)
  File "/nfs/users/ext_group8/Repos/BroaderDG/domainbed/algorithms.py", line 1056, in update
    loss.backward()
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/site-packages/torch/_tensor.py", line 255, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/site-packages/torch/autograd/__init__.py", line 147, in backward
    Variable._execution_engine.run_backward(
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn
Environment:
	Python: 3.8.11
	PyTorch: 1.9.0+cu102
	Torchvision: 0.10.0+cu102
	CUDA: 10.2
	CUDNN: 7605
	NumPy: 1.21.1
	PIL: 9.1.0
Args:
	algorithm: Clip_train_prompt_from_image
	checkpoint_freq: None
	data_dir: /nfs/users/ext_group8/Dataset/224_data/
	dataset: DR
	holdout_fraction: 0.2
	hparams: {"weight_init":"clip_full","backbone":"ClipBase","lr":0.000005}
	hparams_seed: 0
	output_dir: ./domainbed/Outputs/ZZZ_SANOJAN_RND/000f5b7c71ff60fffd66ac229b0785f1
	save_best_model: True
	save_model_every_checkpoint: False
	seed: 1816901014
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	backbone: ClipBase
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	test_env: [3]
	weight_decay: 0.0
	weight_init: clip_full
device: cuda
3
transformer_width: 512 ;transformer_layers: 12 ;transformer_heads: 8
512 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
torch.Size([96, 512]) torch.Size([96, 77, 512]) torch.Size([96, 4, 512])
Traceback (most recent call last):
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/nfs/users/ext_group8/Repos/BroaderDG/domainbed/scripts/train.py", line 347, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)
  File "/nfs/users/ext_group8/Repos/BroaderDG/domainbed/algorithms.py", line 1056, in update
    loss.backward()
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/site-packages/torch/_tensor.py", line 255, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/nfs/users/ext_sanoojan.baliah/miniconda3/envs/dgbed4/lib/python3.8/site-packages/torch/autograd/__init__.py", line 147, in backward
    Variable._execution_engine.run_backward(
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn
WARNING: using experimental multi_gpu_launcher.
Launched 4 jobs!
